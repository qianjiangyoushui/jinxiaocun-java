<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Jxdj">
	
	<!-- 缓存条数 -->
	<cache size="2000" />
	
	<!-- 条件语句 -->
	<sql id="WhereSQL">
		<where>
			<if test="guid != null and guid != ''"> 
			AND T.GUID = #{guid} 
			</if>
			<if test="createdate != null and createdate != ''"> 
			AND T.CREATEDATE = #{createdate} 
			</if>
			<if test="money != null and money != ''"> 
			AND T.MONEY = #{money} 
			</if>
			<if test="lastupdate != null and lastupdate != ''"> 
			AND T.LASTUPDATE = #{lastupdate} 
			</if>
			<if test="type != null and type != ''"> 
			AND T.TYPE = #{type} 
			</if>
			<if test="projectid != null and projectid != ''"> 
			AND T.PROJECTID = #{projectid} 
			</if>
		</where>
	</sql>
	
	<!-- 查找语句 -->
	<select id="find" resultType="Jxdj" parameterType="Jxdj" flushCache="false" useCache="true">
    	SELECT 
	    	T.GUID AS guid, 
	    	T.CREATEDATE AS createdate, 
	    	T.MONEY AS money, 
	    	T.LASTUPDATE AS lastupdate, 
	    	T.TYPE AS type, 
	    	T.PROJECTID AS projectid 
    	FROM jxdj T
		<include refid="WhereSQL" />
	</select>
	
	<!-- 获取总记录数语句 -->
	<select id="findCount" resultType="java.lang.Integer" parameterType="Jxdj" flushCache="false" useCache="true">
    	SELECT COUNT(*)  FROM jxdj T
		<include refid="WhereSQL" />
	</select>
	
	<!-- 插入语句 -->
	<insert id="insert" parameterType="Jxdj" flushCache="true"> 
		INSERT INTO jxdj
		(
			GUID, 
			CREATEDATE, 
			MONEY, 
			LASTUPDATE, 
			TYPE, 
			PROJECTID 
		 ) 
		VALUES
		(
			#{guid,jdbcType=VARCHAR}, 
			#{createdate,jdbcType=DATE}, 
			#{money,jdbcType=DECIMAL}, 
			#{lastupdate,jdbcType=DATE}, 
			#{type,jdbcType=VARCHAR}, 
			#{projectid,jdbcType=VARCHAR} 
		) 
	</insert>
	
	<!-- 更新语句 -->
	<update id="update"  parameterType="Jxdj" flushCache="true"> 
		update jxdj 
		<set> 
			<if test="guid != null">GUID=#{guid},</if>
			<if test="createdate != null">CREATEDATE=#{createdate},</if>
			<if test="money != null">MONEY=#{money},</if>
			<if test="lastupdate != null">LASTUPDATE=#{lastupdate},</if>
			<if test="type != null">TYPE=#{type},</if>
			<if test="projectid != null">PROJECTID=#{projectid},</if>
		</set>
		WHERE GUID = #{guid}
	</update> 
	
	<!-- 单选删除语句 -->
	<delete id="delete" parameterType="Jxdj" flushCache="true"> 
		DELETE FROM jxdj WHERE GUID = #{guid}
	</delete>
	
	<!-- 多选删除 -->
	<delete id="mulDel" parameterType="java.lang.String" flushCache="true">
		DELETE FROM jxdj WHERE GUID IN
		<foreach item="id" collection="array" open="(" separator="," close=")"> 
			#{id}
		</foreach> 
	</delete>
	
	<!-- 查找语句 -->
	<select id="findBills" resultType="BillResult" parameterType="Jxdj" flushCache="false" useCache="true">
    	select 
			s.guid as sguid,
			j.guid as jguid ,
			p.guid as pguid,
			p.companyid as companyid,
			p.stockcompany as stockcompany,
			p.supplycompany as supplycompany,
			c.shortname as shortname,
			c.companytype as companytype 
			from settlement s 
			left join jxdj j 
			on s.guid=j.projectid 
			left join projects p 
			on p.guid=s.projectid 
			left join company c 
			on c.guid = p.companyid 
	</select>
	
	
</mapper>
