<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Bottlestore">

    <!-- 缓存条数 -->
    <cache size="2000" />

    <!-- 条件语句 -->
    <sql id="WhereSQL">
        <where>
            <if test="guid != null and guid != ''">
                AND T.GUID = #{guid}
            </if>
            <if test="companyid != null and companyid != ''">
                AND T.COMPANYID = #{companyid}
            </if>
            <if test="batchid != null and batchid != ''">
                AND T.BATCHID = #{batchid}
            </if>
            <if test="year != null and year != ''">
                AND T.YEAR = #{year}
            </if>
            <if test="type != null and type != ''">
                AND T.TYPE = #{type}
            </if>
            <if test="indate != null and indate != ''">
                AND T.INDATE = #{indate}
            </if>
            <if test="month != null and month != ''">
                AND T.MONTH = #{month}
            </if>
            <if test="varietycode != null and varietycode != ''">
                AND T.VARIETYCODE = #{varietycode}
            </if>
            <if test="inamount != null and inamount != ''">
                AND T.INAMOUNT = #{inamount}
            </if>
            <if test="outamount != null and outamount != ''">
                AND T.OUTAMOUNT = #{outamount}
            </if>
            <if test="useamount != null and useamount != ''">
                AND T.USEAMOUNT = #{useamount}
            </if>
            <if test="source != null and source != ''">
                AND T.SOURCE = #{source}
            </if>
            <if test="username != null and username != ''">
                AND T.USERNAME = #{username}
            </if>
            <if test="sort != null and sort != ''">
                AND T.SORT = #{sort}
            </if>
            <if test="remark != null and remark != ''">
                AND T.REMARK = #{remark}
            </if>
        </where>
    </sql>

    <!-- 查找语句 -->
    <select id="find" resultType="Bottlestore" parameterType="Bottlestore" flushCache="false" useCache="true">
        SELECT
        T.GUID AS guid,
        T.COMPANYID AS companyid,
        T.BATCHID AS batchid,
        T.YEAR AS year,
        T.TYPE AS type,
        T.INDATE AS indate,
        T.MONTH AS month,
        T.VARIETYCODE AS varietycode,
        T.INAMOUNT AS inamount,
        T.OUTAMOUNT AS outamount,
        T.USEAMOUNT AS useamount,
        T.SOURCE AS source,
        T.USERNAME AS username,
        T.SORT AS sort,
        T.REMARK AS remark
        FROM bottlestore T
        <include refid="WhereSQL" />
        ORDER BY INDATE DESC
    </select>

    <!-- 获取总记录数语句 -->
    <select id="findCount" resultType="java.lang.Integer" parameterType="Bottlestore" flushCache="false" useCache="true">
        SELECT COUNT(*)  FROM bottlestore T
        <include refid="WhereSQL" />
    </select>
    <select id="callProcedure" resultType="Bottlestore" parameterType="Bottlestore" statementType="CALLABLE" >
        {
        call bottle_store(
        #{companyid,mode=IN,jdbcType=VARCHAR},
        #{year,mode=IN,jdbcType=VARCHAR},
        #{month,mode=IN,jdbcType=INTEGER}
        )
        }
    </select>
    <!-- 插入语句 -->
    <insert id="insert" parameterType="Bottlestore" flushCache="true">
        INSERT INTO bottlestore
        (
        GUID,
        COMPANYID,
        BATCHID,
        YEAR,
        TYPE,
        INDATE,
        MONTH,
        VARIETYCODE,
        INAMOUNT,
        OUTAMOUNT,
        USEAMOUNT,
        SOURCE,
        USERNAME,
        SORT,
        REMARK
        )
        VALUES
        (
        #{guid,jdbcType=VARCHAR},
        #{companyid,jdbcType=VARCHAR},
        #{batchid,jdbcType=VARCHAR},
        #{year,jdbcType=VARCHAR},
        #{type,jdbcType=INTEGER},
        #{indate,jdbcType=DATE},
        #{month,jdbcType=INTEGER},
        #{varietycode,jdbcType=VARCHAR},
        #{inamount,jdbcType=INTEGER},
        #{outamount,jdbcType=INTEGER},
        #{useamount,jdbcType=INTEGER},
        #{source,jdbcType=VARCHAR},
        #{username,jdbcType=VARCHAR},
        #{sort,jdbcType=INTEGER},
        #{remark,jdbcType=VARCHAR}
        )
    </insert>

    <!-- 更新语句 -->
    <update id="update"  parameterType="Bottlestore" flushCache="true">
        update bottlestore
        <set>
            <if test="guid != null">GUID=#{guid},</if>
            <if test="companyid != null">COMPANYID=#{companyid},</if>
            <if test="batchid != null">BATCHID=#{batchid},</if>
            <if test="year != null">YEAR=#{year},</if>
            <if test="type != null">TYPE=#{type},</if>
            <if test="indate != null">INDATE=#{indate},</if>
            <if test="month != null">MONTH=#{month},</if>
            <if test="varietycode != null">VARIETYCODE=#{varietycode},</if>
            <if test="inamount != null">INAMOUNT=#{inamount},</if>
            <if test="outamount != null">OUTAMOUNT=#{outamount},</if>
            <if test="useamount != null">USEAMOUNT=#{useamount},</if>
            <if test="source != null">SOURCE=#{source},</if>
            <if test="username != null">USERNAME=#{username},</if>
            <if test="sort != null">SORT=#{sort},</if>
            <if test="remark != null">REMARK=#{remark},</if>
        </set>
        WHERE GUID = #{guid}
    </update>

    <!-- 单选删除语句 -->
    <delete id="delete" parameterType="Bottlestore" flushCache="true">
        DELETE FROM bottlestore WHERE GUID = #{guid}
    </delete>

    <!-- 多选删除 -->
    <delete id="mulDel" parameterType="java.lang.String" flushCache="true">
        DELETE FROM bottlestore WHERE GUID IN
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
</mapper>
