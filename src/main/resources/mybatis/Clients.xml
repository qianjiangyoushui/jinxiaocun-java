<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Clients">
	
	<!-- 缓存条数 -->
	<cache size="2000" />
	
	<!-- 条件语句 -->
	<sql id="WhereSQL">
		<where>
			<if test="guid != null and guid != ''"> 
			AND T.GUID = #{guid} 
			</if>
			<if test="clientname != null and clientname != ''"> 
			AND T.CLIENTNAME = #{clientname} 
			</if>
			<if test="tlephone != null and tlephone != ''"> 
			AND T.TLEPHONE = #{tlephone} 
			</if>
			<if test="plantarea != null and plantarea != ''"> 
			AND T.PLANTAREA = #{plantarea} 
			</if>
			<if test="province != null and province != ''"> 
			AND T.PROVINCE = #{province} 
			</if>
			<if test="city != null and city != ''"> 
			AND T.CITY = #{city} 
			</if>
			<if test="area != null and area != ''"> 
			AND T.AREA = #{area} 
			</if>
			<if test="street != null and street != ''"> 
			AND T.STREET = #{street} 
			</if>
			<if test="companyid != null and companyid != ''"> 
			AND T.COMPANYID = #{companyid} 
			</if>
			<if test="createdate != null and createdate != ''"> 
			AND T.CREATEDATE = #{createdate} 
			</if>
			<if test="operatorid != null and operatorid != ''"> 
			AND T.OPERATORID = #{operatorid} 
			</if>
		</where>
	</sql>
	
	<!-- 查找语句 -->
	<select id="find" resultType="Clients" parameterType="Clients" flushCache="false" useCache="true">
    	SELECT 
	    	T.GUID AS guid, 
	    	T.CLIENTNAME AS clientname, 
	    	T.TLEPHONE AS tlephone, 
	    	T.PLANTAREA AS plantarea, 
	    	T.PROVINCE AS province, 
	    	T.CITY AS city, 
	    	T.AREA AS area, 
	    	T.STREET AS street, 
	    	T.COMPANYID AS companyid, 
	    	T.CREATEDATE AS createdate, 
	    	T.OPERATORID AS operatorid ,
	    	u.url as url 
    	FROM clients T 
    	left join upimage u 
    	on T.guid = u.relatedid 
		<include refid="WhereSQL" />
		ORDER BY T.CREATEDATE 
	</select>
	
	<!-- 获取总记录数语句 -->
	<select id="findCount" resultType="java.lang.Integer" parameterType="Clients" flushCache="false" useCache="true">
    	SELECT COUNT(*)  FROM clients T
		<include refid="WhereSQL" />
	</select>
	
	<!-- 插入语句 -->
	<insert id="insert" parameterType="Clients" flushCache="true"> 
		INSERT INTO clients
		(
			GUID, 
			CLIENTNAME, 
			TLEPHONE, 
			PLANTAREA, 
			PROVINCE, 
			CITY, 
			AREA, 
			STREET, 
			COMPANYID, 
			CREATEDATE, 
			OPERATORID 
		 ) 
		VALUES
		(
			#{guid,jdbcType=VARCHAR}, 
			#{clientname,jdbcType=VARCHAR}, 
			#{tlephone,jdbcType=VARCHAR}, 
			#{plantarea,jdbcType=DECIMAL}, 
			#{province,jdbcType=VARCHAR}, 
			#{city,jdbcType=VARCHAR}, 
			#{area,jdbcType=VARCHAR}, 
			#{street,jdbcType=VARCHAR}, 
			#{companyid,jdbcType=VARCHAR}, 
			#{createdate,jdbcType=DATE}, 
			#{operatorid,jdbcType=VARCHAR} 
		) 
	</insert>
	
	<!-- 更新语句 -->
	<update id="update"  parameterType="Clients" flushCache="true"> 
		update clients 
		<set> 
			<if test="guid != null">GUID=#{guid},</if>
			<if test="clientname != null">CLIENTNAME=#{clientname},</if>
			<if test="tlephone != null">TLEPHONE=#{tlephone},</if>
			<if test="plantarea != null">PLANTAREA=#{plantarea},</if>
			<if test="province != null">PROVINCE=#{province},</if>
			<if test="city != null">CITY=#{city},</if>
			<if test="area != null">AREA=#{area},</if>
			<if test="street != null">STREET=#{street},</if>
			<if test="companyid != null">COMPANYID=#{companyid},</if>
			<if test="createdate != null">CREATEDATE=#{createdate},</if>
			<if test="operatorid != null">OPERATORID=#{operatorid},</if>
		</set>
		WHERE GUID = #{guid}
	</update> 
	
	<!-- 单选删除语句 -->
	<delete id="delete" parameterType="Clients" flushCache="true"> 
		DELETE FROM clients WHERE GUID = #{guid}
	</delete>
	
	<!-- 多选删除 -->
	<delete id="mulDel" parameterType="java.lang.String" flushCache="true">
		DELETE FROM clients WHERE GUID IN
		<foreach item="id" collection="array" open="(" separator="," close=")"> 
			#{id}
		</foreach> 
	</delete>
</mapper>
