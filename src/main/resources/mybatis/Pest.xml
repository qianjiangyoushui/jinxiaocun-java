<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Pest">
	
	<!-- 缓存条数 -->
	<cache size="2000" />
	
	<!-- 条件语句 -->
	<sql id="WhereSQL">
		<where>
			<if test="guid != null and guid != ''"> 
			AND T.GUID = #{guid} 
			</if>
			<if test="seedfileid != null and seedfileid != ''"> 
			AND T.SEEDFILEID = #{seedfileid} 
			</if>
			<if test="happendate != null and happendate != ''"> 
			AND T.HAPPENDATE = #{happendate} 
			</if>
			<if test="pesttype != null and pesttype != ''"> 
			AND T.PESTTYPE = #{pesttype} 
			</if>
			<if test="placecode != null and placecode != ''"> 
			AND T.PLACECODE = #{placecode} 
			</if>
			<if test="probability != null and probability != ''"> 
			AND T.PROBABILITY = #{probability} 
			</if>
			<if test="principal != null and principal != ''"> 
			AND T.PRINCIPAL = #{principal} 
			</if>
			<if test="createdate != null and createdate != ''"> 
			AND T.CREATEDATE = #{createdate} 
			</if>
			<if test="operatorid != null and operatorid != ''"> 
			AND T.OPERATORID = #{operatorid} 
			</if>
		</where>
	</sql>
	
	<!-- 查找语句 -->
	<select id="find" resultType="Pest" parameterType="Pest" flushCache="false" useCache="true">
    	SELECT 
	    	T.GUID AS guid, 
	    	T.SEEDFILEID AS seedfileid, 
	    	T.HAPPENDATE AS happendate, 
	    	T.PESTTYPE AS pesttype, 
	    	T.PLACECODE AS placecode, 
	    	T.PROBABILITY AS probability, 
	    	T.PRINCIPAL AS principal, 
	    	T.CREATEDATE AS createdate, 
	    	T.OPERATORID AS operatorid ,
	    	u.USERNAME as name
    	FROM pest T
    	left join users u on T.OPERATORID = u.guid
		<include refid="WhereSQL" />
		ORDER BY T.CREATEDATE desc
	</select>
	
	<!-- 获取总记录数语句 -->
	<select id="findCount" resultType="java.lang.Integer" parameterType="Pest" flushCache="false" useCache="true">
    	SELECT COUNT(*)  FROM pest T
		<include refid="WhereSQL" />
	</select>
	
	<!-- 插入语句 -->
	<insert id="insert" parameterType="Pest" flushCache="true"> 
		INSERT INTO pest
		(
			GUID, 
			SEEDFILEID, 
			HAPPENDATE, 
			PESTTYPE, 
			PLACECODE, 
			PROBABILITY, 
			PRINCIPAL, 
			CREATEDATE, 
			OPERATORID 
		 ) 
		VALUES
		(
			#{guid,jdbcType=VARCHAR}, 
			#{seedfileid,jdbcType=VARCHAR}, 
			#{happendate,jdbcType=DATE}, 
			#{pesttype,jdbcType=VARCHAR}, 
			#{placecode,jdbcType=VARCHAR}, 
			#{probability,jdbcType=DECIMAL}, 
			#{principal,jdbcType=VARCHAR}, 
			#{createdate,jdbcType=DATE}, 
			#{operatorid,jdbcType=VARCHAR} 
		) 
	</insert>
	
	<!-- 更新语句 -->
	<update id="update"  parameterType="Pest" flushCache="true"> 
		update pest 
		<set> 
			<if test="guid != null">GUID=#{guid},</if>
			<if test="seedfileid != null">SEEDFILEID=#{seedfileid},</if>
			<if test="happendate != null">HAPPENDATE=#{happendate},</if>
			<if test="pesttype != null">PESTTYPE=#{pesttype},</if>
			<if test="placecode != null">PLACECODE=#{placecode},</if>
			<if test="probability != null">PROBABILITY=#{probability},</if>
			<if test="principal != null">PRINCIPAL=#{principal},</if>
			<if test="createdate != null">CREATEDATE=#{createdate},</if>
			<if test="operatorid != null">OPERATORID=#{operatorid},</if>
		</set>
		WHERE GUID = #{guid}
	</update> 
	
	<!-- 单选删除语句 -->
	<delete id="delete" parameterType="Pest" flushCache="true"> 
		DELETE FROM pest WHERE GUID = #{guid}
	</delete>
	
	<!-- 多选删除 -->
	<delete id="mulDel" parameterType="java.lang.String" flushCache="true">
		DELETE FROM pest WHERE GUID IN
		<foreach item="id" collection="array" open="(" separator="," close=")"> 
			#{id}
		</foreach> 
	</delete>
</mapper>
