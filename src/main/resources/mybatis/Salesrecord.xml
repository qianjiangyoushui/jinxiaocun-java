<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Salesrecord">
	
	<!-- 缓存条数 -->
	<cache size="2000" />
	
	<!-- 条件语句 -->
	<sql id="WhereSQL">
		<where>
			<if test="guid != null and guid != ''"> 
			AND T.GUID = #{guid} 
			</if>
			<if test="clientid != null and clientid != ''"> 
			AND T.CLIENTID = #{clientid} 
			</if>
			<if test="seedid != null and seedid != ''"> 
			AND T.SEEDID = #{seedid} 
			</if>
			<if test="companyid != null and companyid != ''"> 
			AND T.COMPANYID = #{companyid} 
			</if>
			<if test="batch != null and batch != ''"> 
			AND T.BATCH = #{batch} 
			</if>
			<if test="salesamount != null and salesamount != ''"> 
			AND T.SALESAMOUNT = #{salesamount} 
			</if>
			<if test="salesdate != null and salesdate != ''"> 
			AND T.SALESDATE = #{salesdate} 
			</if>
			<if test="carlicense != null and carlicense != ''"> 
			AND T.CARLICENSE = #{carlicense} 
			</if>
			<if test="depotid != null and depotid != ''"> 
			AND T.DEPOTID = #{depotid} 
			</if>
			<if test="createdate != null and createdate != ''"> 
			AND T.CREATEDATE = #{createdate} 
			</if>
			<if test="operatorid != null and operatorid != ''"> 
			AND T.OPERATORID = #{operatorid} 
			</if>
		</where>
	</sql>
	
	<!-- 查找语句 -->
	<select id="find" resultType="Salesrecord" parameterType="Salesrecord" flushCache="false" useCache="true">
    	SELECT 
	    	T.GUID AS guid, 
	    	T.CLIENTID AS clientid, 
	    	T.SEEDID AS seedid, 
	    	T.COMPANYID AS companyid, 
	    	T.BATCH AS batch, 
	    	T.SALESAMOUNT AS salesamount, 
	    	T.SALESDATE AS salesdate, 
	    	T.CARLICENSE AS carlicense, 
	    	T.DEPOTID AS depotid, 
	    	T.CREATEDATE AS createdate, 
	    	T.OPERATORID AS operatorid,
	    	s.batch as seedbatch,
	    	 d.depotcode as depotcode
    	FROM salesrecord T left join seedfile  s
    	on T.seedid=s.guid left join depot d
    	on T.depotid=d.guid
		<include refid="WhereSQL" />
		ORDER BY T.CREATEDATE 
	</select>
	
	<!-- 获取总记录数语句 -->
	<select id="findCount" resultType="java.lang.Integer" parameterType="Salesrecord" flushCache="false" useCache="true">
    	SELECT COUNT(*)  FROM salesrecord T
		<include refid="WhereSQL" />
	</select>
	
	<!-- 插入语句 -->
	<insert id="insert" parameterType="Salesrecord" flushCache="true"> 
		INSERT INTO salesrecord
		(
			GUID, 
			CLIENTID, 
			SEEDID, 
			COMPANYID, 
			BATCH, 
			SALESAMOUNT, 
			SALESDATE, 
			CARLICENSE, 
			DEPOTID, 
			CREATEDATE, 
			OPERATORID 
		 ) 
		VALUES
		(
			#{guid,jdbcType=VARCHAR}, 
			#{clientid,jdbcType=VARCHAR}, 
			#{seedid,jdbcType=VARCHAR}, 
			#{companyid,jdbcType=VARCHAR}, 
			#{batch,jdbcType=VARCHAR}, 
			#{salesamount,jdbcType=DECIMAL}, 
			#{salesdate,jdbcType=DATE}, 
			#{carlicense,jdbcType=VARCHAR}, 
			#{depotid,jdbcType=VARCHAR}, 
			#{createdate,jdbcType=DATE}, 
			#{operatorid,jdbcType=VARCHAR} 
		) 
	</insert>
	
	<!-- 更新语句 -->
	<update id="update"  parameterType="Salesrecord" flushCache="true"> 
		update salesrecord 
		<set> 
			<if test="guid != null">GUID=#{guid},</if>
			<if test="clientid != null">CLIENTID=#{clientid},</if>
			<if test="seedid != null">SEEDID=#{seedid},</if>
			<if test="companyid != null">COMPANYID=#{companyid},</if>
			<if test="batch != null">BATCH=#{batch},</if>
			<if test="salesamount != null">SALESAMOUNT=#{salesamount},</if>
			<if test="salesdate != null">SALESDATE=#{salesdate},</if>
			<if test="carlicense != null">CARLICENSE=#{carlicense},</if>
			<if test="depotid != null">DEPOTID=#{depotid},</if>
			<if test="createdate != null">CREATEDATE=#{createdate},</if>
			<if test="operatorid != null">OPERATORID=#{operatorid},</if>
		</set>
		WHERE GUID = #{guid}
	</update> 
	
	<!-- 单选删除语句 -->
	<delete id="delete" parameterType="Salesrecord" flushCache="true"> 
		DELETE FROM salesrecord WHERE GUID = #{guid}
	</delete>
	
	<!-- 多选删除 -->
	<delete id="mulDel" parameterType="java.lang.String" flushCache="true">
		DELETE FROM salesrecord WHERE GUID IN
		<foreach item="id" collection="array" open="(" separator="," close=")"> 
			#{id}
		</foreach> 
	</delete>
	
	
	<!-- 查找语句 -->
	<select id="findlist" resultMap="listResult" parameterType="Salesrecord" flushCache="false" useCache="true">
    	SELECT 
	    	T.GUID AS guid, 
	    	T.CLIENTID AS clientid, 
	    	T.SEEDID AS seedid, 
	    	T.COMPANYID AS companyid, 
	    	T.BATCH AS batch, 
	    	T.SALESAMOUNT AS salesamount, 
	    	T.SALESDATE AS salesdate, 
	    	T.CARLICENSE AS carlicense, 
	    	T.DEPOTID AS depotid, 
	    	T.CREATEDATE AS createdate, 
	    	T.OPERATORID AS operatorid ,
	    	c.guid as c_guid,
	    	c.clientname as clientname 
    	FROM salesrecord T 
    	left join clients c 
    	on T.clientid =c.guid 
		<include refid="WhereSQL" />
		ORDER BY T.CREATEDATE 
	</select>
	
	<resultMap type="Salesrecord" id="listResult">
		<id column="guid" property="guid"/>
		<result property="clientid" column="clientid"/>
		<result property="seedid" column="seedid"/>
		<result property="companyid" column="companyid"/>
		<result property="batch" column="batch"/>
		<result property="salesamount" column="salesamount"/>
		<result property="salesdate" column="salesdate"/>
		<result property="carlicense" column="carlicense"/>
		<result property="depotid" column="depotid"/>
		<result property="createdate" column="createdate"/>
		<result property="operatorid" column="operatorid"/>
		<association property="client" javaType="Clients">
			<id column="c_guid" property="guid"/>
			<result property="clientname" column="clientname"/>
		</association>
	</resultMap>
	
</mapper>
